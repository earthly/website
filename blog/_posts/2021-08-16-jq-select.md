---
title: "JQ Select Explained: Selecting elements from JSON with Examples"
categories:
  - Tutorials
toc: true
author: Adam
internal-links:
 - just an example
---
### Writing Article Checklist

- [ ] Write Outline
- [ ] Write Draft
- [ ] Fix Grammarly Errors
- [ ] Read out loud
- [ ] Write 5 or more titles and pick the best on
- [ ] First two paragraphs: What's it about? Why listen to you?
- [ ] Create header image in Canva
- [ ] Optional: Find ways to break up content with quotes or images
- [ ] Verify look of article locally
- [ ] Run mark down linter (`earthly +blog-lint-apply`)
- [ ] Add keywords for internal links to front-matter
- [ ] Run `earthly --build-arg NAME=2020-09-10-better-builds.md +link-opportunity` and find 1-5 places to incorporate links to other articles
- [ ] Raise PR


- Keyword: jq select
- Long tail keywords:
    - jq select multiple fields
    - jq select examples
    - jq select key value
    - jq remove quotes
    - jq filter by value
    - jq count
    - jq sort
    - jq json to csv
    - jq map
    - jq array
    - harder ones
        - what is jq
        - jq filter
        - 

Some shortcuts and command line tools I use so much that using them is just in my fingers. I don't have to remember how to use them, my fingers just know how. 

I hit save in VS Code all the time, despite the fact that VS Code autosaves. It's like a nervous tick: if I pause my typing my fingers hit Command-S. The shortcut for saving files is in my fingers[^1]. 

`git commit / git add` is similarly in my fingers. I often commit my work almost automatically when I reach a stopping point. Rebasing changes into my code is different. I have to think about it each time. It's in my head not my fingers.

However, some things never stick in my head nor in my fingers and I have to go to google every time. JQ is one of these. It's time to fix that. Let's go over selecting elements out of a JSON string using JQ in enough depth that it should stick in both my and your head.

## What is JQ
JQ is a lightweight, command-line JSON processor. It a single portable executable that is less than 1 MB is size but it is by no means a simple tool. To use JQ you construct one or more filters and JQ applies those filters to a JSON document. 

When I'm using JQ, it is primarily to select some subset of a json document or to perform some type of transformation and that is what I'll primarily cover here but its important to realise that whatever you are doing in jq, you are doing it via creating and combining together filters. 

The simplest filter is the identity filter which returns all its input (`.`):

```
echo '{"key1":{"key2":"value1"}}' | jq '.'
{
  "key1": {
    "key2": "value1"
  }
}
```
<div class="notice">
By default jq pretty prints all its output. Whenever jq returns some data, its implied, though not specifically stated, that the data has be pretty printed.
</div>

## Using JQ to Select Elements
Let's start learning how to select elements using the GitHub api for `jq`.
``` json
curl https://api.github.com/repos/stedolan/jq

{
  "id": 5101141,
  "node_id": "MDEwOlJlcG9zaXRvcnk1MTAxMTQx",
  "name": "jq",
  "full_name": "stedolan/jq",
  "private": false,
  "owner": {
    "login": "stedolan",
    "id": 79765
  },
  "html_url": "https://github.com/stedolan/jq",
  "description": "Command-line JSON processor",
  "stargazers_count": 19967,
  "watchers_count": 19967,
  "language": "C",
  "license": {
    "key": "other",
    "name": "Other",
    "spdx_id": "NOASSERTION",
    "url": null,
    "node_id": "MDc6TGljZW5zZTA="
  },
}
```

<div class="notice">
The JSON documents returned by the GitHub API are in many cases quite large. Non relevant details will be omitted in this tutorial.
</div>

`jq` lets us treat the JSON document as an object, and select elements inside of it.

``` json
curl https://api.github.com/repos/stedolan/jq | jq ' .name' 
"jq"
```
<figcaption>Filter JSON document to select value of name key. Value is a string.</figcaption>

``` json
curl https://api.github.com/repos/stedolan/jq | jq ' .owner' 
{
    "login": "stedolan",
    "id": 79765
}
```
<figcaption>Filter JSON document to select value of owner key. Value is an object</figcaption>


``` json
https://api.github.com/repos/stedolan/jq ' .owner.login' 
"stedolan"
```
<figcaption>Filter JSON document to select value of `owner.login`</figcaption>

## Using JQ to Select Arrays
If we use the GitHub Issues API for `jq` we get back an array of issues:
``` json
curl https://api.github.com/repos/stedolan/jq/issues?per_page=5    
[
  {
    "id": 966024429,
    "number": 2341,
    "title": "Question about license.",
    "body": "I would like to create a [winget](https://github.com/microsoft/winget-cli) package for jq. üôèüèª"
  },
  {
  
    "id": 962477084,
    "number": 2340,
    "title": "visibility of wiki pages",
    "body": "The visibility of wiki pages to search engines is generally limited; for example, the search result for \"jq Cookbook\" looks like this:"
  },
  {
   
    "id": 955350543,
    "number": 2337,
    "title": "Release 1.6 does not have pre-autoreconf'ed configure script",
    "body": "If you have a usage question, please ask us on either Stack Overflow (https://stackoverflow.com/questions/tagged/jq) or in the #jq channel (http://irc.lc/freenode/%23jq/) on Freenode (https://webchat.freenode.net/)."
  },
  {
    "id": 954792209,
    "number": 2336,
    "title": "Fix typo",
    "body": ""
  },
  {
    "id": 940627936,
    "number": 2334,
    "title": "Compile error messages don't provide column only line number",
    "body": "Compile errors in filter expressions don't include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful."
  }
]
```
To get a specific element in the array give an index
```
curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq '.[4]' 
 {
    "id": 940627936,
    "number": 2334,
    "title": "Compile error messages don't provide column only line number",
    "body": "Compile errors in filter expressions don't include the column number where the parser approximately or exactly locates the error. Most filter expressions are one-liners (are multiple lines even supported?), so the information that the error is on line 1 is not helpful."
  }
```
<div class="notice">
Array indexing has some nice convenience functions. 

You can select ranges:
```
$ echo "[1,2,3,4,5]" | jq '.[2:4]'
[3,4]
```
You can select one sided ranges:
```
$ echo "[1,2,3,4,5]" | jq '.[2:]'
[3,4,5]
```

You can use negatives to select from the end:
```
$ echo "[1,2,3,4,5]" | jq '.[-2:]'
[4,5]
```
</div>

You can use the array indexing with the object indexing:
```
$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq '.[4].title' 
"Compile error messages don't provide column only line number"
```
And you can use `[]` to get all the elements in array. This is useful when you want to apply furthering filtering to elements of the array. Here is how we would get the titles of  the jq issues returned by our api request :
``` json
$ curl https://api.github.com/repos/stedolan/jq/issues?per_page=5 | jq '.[].title' 
"Question about license."
"visibility of wiki pages"
"Release 1.6 does not have pre-autoreconf'ed configure script"
"Fix typo"
"Compile error messages don't provide column only line number"
```

<div class="notice">
**‚ùó Removing Quotes From JQ Output**
If you need to have raw strings, the `-r` option in `jq` gives you that.
``` json
$ echo '["1","2","3"]' | jq -r '.[]'
1
2
3
```
The `-j` option (for join) can also be use to combine together output.
``` json
$ echo '["1","2","3"]' | jq -j '.[]'
123
```
</div>





























Let's start with selecting elements from a simple json document. For t
``` json
[
  {
    "key1": {
      "subkey1": "value1a",
      "subkey2": "value1b"
    }
  },
  {
    "key1": {
     "subkey1": "value1a",
      "subkey2": "value1b"
    }
  }
]
```
<figcaption>simple.json</figcaption>

We already know we can select the full document using `jq .`. From there we can drill further into the document by specifying a selector path:
``` json
$ jq '.[]' < simple.json 
{
  "key1": {
    "subkey1": "value1a",
    "subkey2": "value1b"
  }
}
{
  "key1": {
    "subkey1": "value1a",
    "subkey2": "value1b"
  }
}
```
<figcaption>Get Elements with the Array with `jq`</figcaption>

``` json
jq '.[].key1' < simple.json
{
  "subkey1": "value1a",
  "subkey2": "value1b"
}
{
  "subkey1": "value1a",
  "subkey2": "value1b"
}
```
<figcaption>Get only children of 'key1` with `jq`</figcaption>

```
jq '.[].key1.subkey1' < simple.json
"value1a"
"value1a"
```
<figcaption>Get only children of 'subkey1` with `jq`</figcaption>



![]({{site.images}}{{page.slug}}/0880.png)
<figcaption>Summary of selecting child elements with `jq`</figcaption>

# Prblems -> this is not valid JSON

# Using it to Select Multiple Fields
# Using the select function
# Selecting keys by values
# Selecting and counting
# Selecting and mapping
# Selecting and sorting
# Removing Quotes
# Selecting and Transforming with Map  
# 


Exmaple tutorials:
http://www.compciv.org/recipes/cli/jq-for-parsing-json/
https://stedolan.github.io/jq/tutorial/



[^1]: Automated behaviour is stored in your Basal ganglia. It just feels like its in my fingers because it fires at a level below my awareness. 